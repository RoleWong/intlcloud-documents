본문에서는 TencentDB for MySQL 콘솔에서 데이터베이스 프록시 연결 주소를 설정하는 방법을 설명합니다.

데이터베이스 프록시 연결 주소는 원래 데이터베이스 연결 주소와 독립적입니다. 프록시 주소에서 프록시된 요청은 모두 프록시 클러스터를 통해 데이터베이스의 원본 및 복제본 노드로 릴레이되므로 읽기 및 쓰기 요청이 분리되고 읽기는 읽기 전용 인스턴스로 전달됩니다. 이러한 방식으로 원본 데이터베이스의 부하가 낮아집니다.
TencentDB for MySQL에 대해 데이터베이스 프록시가 활성화되면 데이터베이스 프록시 연결 주소가 기본적으로 추가되며 데이터베이스 프록시에 대한 연결 주소를 추가, 수정 또는 삭제할 수도 있습니다.

## 전제 조건
[데이터베이스 프록시 활성화](https://www.tencentcloud.com/document/product/236/42052)가 완료되어 있어야 합니다.

## 데이터베이스 프록시 연결 주소 수정
1. [MySQL 콘솔](https://console.cloud.tencent.com/cdb)에 로그인한 뒤, 인스턴스 리스트에서 프록시가 활성화된 프라이머리 인스턴스를 선택하고, 인스턴스 ID를 클릭하거나 **작업** 열에서 **관리**를 클릭하여 인스턴스 관리 페이지로 이동합니다.
2. 인스턴스 관리 페이지에서 **데이터베이스 프록시** 탭을 선택하고 **연결 주소** 탭에서 **사설망 액세스 주소** 뒤에 있는 <img src="https://main.qcloudimg.com/raw/be716b5360d5256a9d5e816e29872ec1.png"  style="margin:0;"> 아이콘을 클릭합니다.
![](https://main.qcloudimg.com/raw/63015c402bdd31e04e2597af84013a74.png)
3. 팝업 대화 상자에서 프록시 주소 수정 후 **확인**을 클릭합니다.
>!프록시 주소를 수정하면 현재 액세스 중인 데이터베이스의 작업에 영향을 줄 수 있으니 사용량이 적은 시간에 주소를 수정하는 것이 좋습니다. 비즈니스에 재연결 메커니즘이 있는지 확인하십시오.
>
![](https://main.qcloudimg.com/raw/982fd53d880ab1a6d4f8df0372a99613.png)

## 데이터베이스 프록시 연결 주소 추가
>?
>- 연결 주소의 개수는 데이터베이스 프록시 노드의 개수와 동일합니다.
>- 데이터베이스 프록시가 활성화되면 기본적으로 연결 주소가 생성됩니다.
>
1. [MySQL 콘솔](https://console.cloud.tencent.com/cdb)에 로그인한 뒤, 인스턴스 리스트에서 프록시를 활성화한 프라이머리 인스턴스를 선택하고, 인스턴스 ID 혹은 **작업**열의 **관리**를 클릭하여 인스턴스 관리 페이지로 이동합니다.
2. 인스턴스 관리 페이지에서 **데이터베이스 프록시** 탭을 선택하고 **연결 주소** 뒤에 있는 **액세스 주소 추가**를 클릭합니다.
![](https://staticintl.cloudcachetci.com/yehe/backend-news/iVTk464_19.png)
3. 연결 생성 창에서 다음 구성 항목을 설정하고 **확인**을 클릭합니다.
**1단계: 네트워크 구성**
<table>
<thead><tr><th>매개변수</th><th>설명</th></tr></thead>
<tbody><tr>
<td>네트워크</td>
<td>데이터베이스 프록시는 VPC만 지원합니다. 주소를 자동으로 할당하거나 지정하도록 선택할 수 있습니다.</td></tr>
<tr>
<td>보안 그룹</td>
<td>소스 인스턴스의 보안 그룹은 기본적으로 선택됩니다. 또 다른 기존 보안 그룹을 선택하거나 필요에 따라 새 보안 그룹을 생성할 수도 있습니다. <blockquote class="rno-document-tips rno-document-tips-notice">    <div class="rno-document-tips-body">        <i class="rno-document-tip-icon"></i>        <div class="rno-document-tip-title">참고</div>        <div class="rno-document-tip-desc"><p>데이터베이스 프록시를 통해 액세스하려면 보안 그룹 정책을 구성하고 사설 포트(3306)를 열어야 합니다. 자세한 내용은 <a href="https://intl.cloud.tencent.com/document/product/236/14470">MySQL 보안 그룹 관리</a>를 참고하십시오.</p></div>    </div></blockquote></td></tr>
<tr>
<td>비고</td>
<td>선택사항. 새 데이터베이스 프록시 연결 주소에 대한 설명을 추가할 수 있습니다.</td></tr>
</tbody></table>
<b>2단계: 정책 구성</b>
<table>
<thead><tr><th>매개변수</th><th>설명</th></tr></thead>
<tbody><tr>
<td>읽기-쓰기 속성</td>
<td>프록시 액세스 주소의 읽기-쓰기 속성을 선택하십시오. 읽기/쓰기 분리 또는 **읽기 전용**일 수 있습니다.</td></tr>
<tr>
<td>지연된 RO 인스턴스 제거</td>
<td>지연된 RO 인스턴스 제거 정책을 설정합니다. 이 옵션을 활성화한 후 지연 임계값 및 최소 RO 인스턴스를 설정할 수 있습니다. 시스템은 이 옵션의 활성화 여부에 관계없이 실패한 읽기 전용 인스턴스를 제거하거나 복원하려고 시도합니다. <ul><li>지연 임계값: 1보다 크거나 같은 정수(초)를 입력합니다. </li><li>최소 RO 인스턴스: 소스 인스턴스가 소유한 읽기 전용 인스턴스의 수에 따라 달라집니다. 0으로 설정하면 모든 읽기 전용 노드가 제거될 때 제거된 읽기 전용 인스턴스 중 하나 이상이 데이터베이스 프록시에 다시 합류하여 읽기 요청 처리를 계속할 때까지 모든 읽기 요청이 소스 인스턴스로 라우팅됩니다. </li></ul></td></tr>
<tr>
<td>연결 풀 상태</td>
<td>연결 풀 기능은 주로 비영구 연결 비즈니스 시나리오에서 빈번한 새 연결로 인해 발생하는 인스턴스 로드를 완화합니다. 이 옵션이 활성화되면 지원되는 연결 풀 유형을 선택할 수 있으며 현재 기본적으로 세션 수준 연결 풀만 가능합니다.</td></tr>
<tr>
<td>트랜잭션 분할</td>
<td>이 기능을 활성화할지 여부를 설정할 수 있습니다. 활성화되면 한 트랜잭션의 읽기 및 쓰기가 실행을 위해 다른 인스턴스로 분리되고 읽기 요청은 읽기 전용 인스턴스로 포워딩되어 소스 인스턴스의 부하를 줄입니다.</td></tr>
<tr>
<td>읽기 가중치 할당</td>
<td>시스템에서 할당 또는 사용자 지정을 선택할 수 있습니다. 데이터베이스 프록시가 활성화되었을 때 여러 AZ가 구성된 경우 서로 다른 AZ에서 프록시 노드의 가중치를 별도로 할당할 수 있습니다.</td></tr>
<tr>
<td>장애 조치(읽기-쓰기 속성이 읽기/쓰기 분리임)</td>
<td>이 기능을 활성화할지 여부를 설정할 수 있습니다. 활성화된 후 데이터베이스 프록시가 실패하면 데이터베이스 프록시 주소가 소스 인스턴스로 요청을 라우팅합니다.</td></tr>
<tr>
<td>새로 추가된 RO 인스턴스에 적용</td>
<td>이 기능을 활성화할지 여부를 설정할 수 있습니다. 활성화되면 새로 구입한 읽기 전용 인스턴스가 데이터베이스 프록시에 자동으로 추가됩니다. <ul><li>읽기 가중치 할당이 시스템에서 할당됨으로 설정된 경우 새로 구매한 읽기 전용 인스턴스에는 사양에 따라 기본 가중치가 할당됩니다. </li><li>읽기 가중치 할당이 사용자 지정으로 설정된 경우 새로 구입한 읽기 전용 인스턴스가 추가되면 해당 가중치는 기본적으로 0이 되며 데이터베이스 프록시 탭의 연결 주소에서 구성 조정을 클릭하여 수정할 수 있습니다.</li></ul></td></tr>
</tbody></table>

## 데이터베이스 프록시 연결 주소 삭제
>? 데이터베이스 프록시에 여러 연결 주소가 있는 경우 마지막 주소를 유지하면서 불필요한 주소를 삭제할 수 있습니다.
>
1. [MySQL 콘솔](https://console.cloud.tencent.com/cdb)에 로그인한 뒤, 인스턴스 리스트에서 프록시를 활성화한 프라이머리 인스턴스를 선택하고, 인스턴스 ID 혹은 **작업**열의 **관리**를 클릭하여 인스턴스 관리 페이지로 이동합니다.
2. 인스턴스 관리 페이지의 **데이터베이스 프록시** > **연결 주소**에서 대상 주소를 찾은 후 **비활성화**를 클릭합니다.
![](https://staticintl.cloudcachetci.com/yehe/backend-news/7FDj373_20.png)
3. 팝업 창에서 **확인**을 클릭합니다.

