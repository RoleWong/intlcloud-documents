## 소개

데이터 처리 워크플로를 사용하면 필요에 따라 비디오 처리 프로세스를 빠르고 유연하게 생성할 수 있습니다. 워크플로는 입력 버킷의 경로에 바인딩됩니다. 비디오 파일이 경로에 **업로드**되면 미디어 워크플로가 **자동으로 트리거**되어 지정된 처리 작업을 수행하고 처리 결과는 대상 버킷의 지정된 경로에 자동으로 저장됩니다.

데이터 처리 워크플로를 사용하여 다음 기능을 구현할 수 있습니다. **오디오/비디오 트랜스코딩(최고 속도 코덱 및 방송 미디어 형식 트랜스코딩 포함)**, **비디오 프레임 캡처**, **비디오를 애니메이션 이미지로 변환**, **지능형 썸네일**, **오디오/비디오 스플라이싱**, **음성 분리**, **하이라이트 생성**, **HLS 어댑티브 멀티 비트레이트**, **SDRtoHDR**, **비디오 향상**, **초고해상도**, **오디오/비디오 세그먼트화**, **사용자 지정 함수** 및 **이미지 프로세싱** 등.

>! 
> - 현재 워크플로는 3gp, asf, avi, dv, flv, f4v, m3u8, m4v, mkv, mov, mp4, mpg, mpeg, mts, ogg, rm, rmvb, swf, vob, wmv, webm, mp3, aac, flac, amr, m4a, wma 및 wav 파일을 처리할 수 있습니다. 미디어 처리 요청을 시작할 때 전체 파일 이름과 확장자를 입력해야 합니다. 그렇지 않으면 형식을 인식하고 처리할 수 없습니다.
> - 현재 워크플로 기능은 업로드 중인 비디오 파일만 작업할 수 있습니다. 클라우드 데이터에 대한 미디어 작업을 수행하려면 [작업](https://intl.cloud.tencent.com/document/product/436/46409) 기능을 사용하십시오.
> 

## 작업 단계

### 워크플로 생성

1. [COS 콘솔](https://console.cloud.tencent.com/cos5)에 로그인합니다.
2. 왼쪽 사이드바에서 **버킷 리스트**를 선택합니다.
3. 미디어 처리를 진행할 버킷의 이름을 클릭하여 버킷 관리 페이지로 이동합니다.
4. 왼쪽 사이드바에서 **데이터 처리 워크플로**를 선택하고 **워크플로**를 클릭하여 워크플로 관리 페이지로 이동합니다.
5. **워크플로 생성**을 클릭합니다.
6. 워크플로 생성 페이지에서 다음 항목을 구성합니다.
![](https://qcloudimg.tencent-cloud.cn/raw/c2bec7689878536a9ddfc52c63fe5991.png)
  - **워크플로 이름**: 필수 항목이며 최대 128자의 중국어 영어 대소문자[A-Z,a-z], 숫자[0-9], 언더바(\_) 및 하이픈(-)을 포함할 수 있습니다.
  - **입력 버킷 이름**: 기본적으로 현재 버킷입니다.
  - **입력 경로**: 선택 사항이며 `/`로 시작하고 끝나야 합니다. 지정하지 않으면 입력 버킷의 모든 경로에 대해 워크플로가 트리거됩니다. 미디어 워크플로가 활성화된 후 비디오 파일이 이 경로에 업로드되면 워크플로가 자동으로 트리거됩니다.
  - **형식**: 기본 오디오/비디오 또는 이미지 파일 필터 규칙 또는 사용자 지정 규칙을 선택합니다. 모든 파일을 선택하여 버킷의 모든 객체를 처리할 수도 있습니다.
  - **큐**: 필수입니다. 서비스를 활성화하면 시스템이 자동으로 사용자 큐를 생성합니다. 작업을 제출하면 작업이 큐에 먼저 정렬되고 제출 우선 순위와 순서에 따라 순서대로 실행됩니다. 공통 구성에서 큐 정보를 볼 수 있습니다.
  - **콜백**: 큐 콜백, 즉 큐에 바인딩된 콜백 URL을 사용할 수 있습니다. 수정하려면 해당 큐 목록으로 이동하십시오.
  - **워크플로 구성**: 오른쪽에서 ‘+’를 클릭하여 다음 노드를 추가합니다. **오디오/비디오 트랜스코딩(최고 속도 코덱 및 방송 미디어 형식 트랜스코딩 포함)**, **비디오 프레임 캡처**, **비디오를 애니메이션 이미지로 변환**, **지능형 썸네일**, **오디오/비디오 스플라이싱**, **음성 분리**, **하이라이트 생성**, **HLS 어댑티브 멀티 비트레이트**, **SDRtoHDR**, **비디오 향상**, **초고해상도**, **오디오/비디오 세그먼트화**, **사용자 지정 함수** 및 **이미지 프로세싱**. 워크플로우에서 하나 이상의 작업 노드를 구성하고 각 작업 노드에 대한 대상 버킷, 파일 이름([워크플로 변수 설명](#1) 참고), 경로 및 작업 템플릿을 설정해야 합니다. 템플릿 및 설정 방법에 대한 자세한 내용은 [템플릿](https://intl.cloud.tencent.com/document/product/436/46411)을 참고하십시오.
<dx-tabs>
::: 오디오/비디오 트랜스코딩
![](https://qcloudimg.tencent-cloud.cn/raw/6a07affd8bcc7a14fd23123a4daf1216.png)
:::
::: 비디오 프레임 캡처
![](https://qcloudimg.tencent-cloud.cn/raw/d449a140aa6aa30409cbd0d4ba517ac3.png)
:::
::: 비디오를 애니메이션 이미지로 변환
![](https://qcloudimg.tencent-cloud.cn/raw/b936967d85e4abd21d2003a552b8ce21.png)
:::
::: 지능형 썸네일
![](https://qcloudimg.tencent-cloud.cn/raw/00fcf5b908905eadb0e4e0920fd69358.png)

설명: 지능형 썸네일 기능은 Tencent Cloud의 고급 AI 기술을 통해 비디오 콘텐츠를 이해하여 3개의 최적 키프레임을 지능적으로 추출합니다.
:::
::: 오디오/비디오 스플라이싱
![](https://qcloudimg.tencent-cloud.cn/raw/0ff1ed35b1f65f404b84435faa2ccf0f.png)
:::
</dx-tabs>
<dx-tabs>
::: 음성 분리
![](https://qcloudimg.tencent-cloud.cn/raw/01ae516306970ab7e0878699843483ad.png)
:::
::: 하이라이트 생성
![](https://qcloudimg.tencent-cloud.cn/raw/d320ea46e01a3969811deecf3ee245ff.png)

:::
::: HLS 어댑티브 멀티 비트레이트
![](https://qcloudimg.tencent-cloud.cn/raw/b6f7821676471e7f505dd4f4e0c09574.png)
설명: HLS 어댑티브 멀티 비트레이트 기능은 멀티 비트레이트 및 오디오 트랙이 포함된 여러 파일을 하나의 멀티 비트레이트 어댑티브 HLS 또는 DASH 비디오 파일로 캡슐화합니다.
:::
::: SDRtoHDR
![](https://qcloudimg.tencent-cloud.cn/raw/51ba2ccf5a680c5217a08cfdbaccc146.png)
:::
::: 비디오 향상

:::
</dx-tabs>
<dx-tabs>
::: 초고해상도

:::
::: 오디오/비디오 세그먼트화
![](https://qcloudimg.tencent-cloud.cn/raw/2fd5506dabedfbc051a13bb019ca601f.png)

:::
::: 사용자 지정 함수

:::
::: 이미지 프로세싱

:::
::: 오디오/비디오 정보(판단 노드)

설명: 오디오/비디오 정보 노드는 다음 노드의 실행 전 조건으로 입력 파일의 종횡비, 파일 길이 및 기타 정보를 판단할 수 있습니다.
:::
</dx-tabs>
7. 구성이 올바른지 확인한 후 **저장**을 클릭합니다.

워크플로는 기본적으로 비활성화되어 있습니다. 워크플로를 활성화하려면 활성화 열에서 토글을 클릭합니다. 활성화되면 워크플로우는 5분 안에 적용됩니다. 그런 다음 이후에 업로드된 비디오 파일에 대해 미디어 처리 작업을 자동으로 수행합니다. 파일을 처리한 후 새로 생성된 파일을 지정된 파일 경로로 출력합니다.

### 워크플로 관리

생성된 워크플로 목록은 워크플로 관리 페이지에서 확인할 수 있습니다.

워크플로 목록에는 워크플로의 이름, 워크플로 ID, 입력 경로, 생성 시간 및 상태가 표시됩니다. 이름 및 ID로 워크플로를 검색하여 지정된 워크플로를 보거나 편집 또는 삭제할 수 있습니다.

 - **활성화**: 워크플로가 활성화되면 입력 버킷의 지정된 경로에 업로드된 비디오 파일이 워크플로 구성에 따라 자동으로 처리됩니다. 토글을 다시 클릭하여 워크플로를 일시 중지할 수 있습니다.
>? 워크플로는 기본적으로 비활성화되어 있습니다. 워크플로를 활성화하려면 활성화 열에서 토글을 클릭합니다. 활성화되면 워크플로우는 5분 안에 적용됩니다.
>
 - **세부 정보**: 현재 워크플로의 구성 세부 정보를 볼 수 있습니다.
 - **실행 인스턴스 보기**: 워크플로 실행 상태 및 시간을 시간별로 볼 수 있습니다.
 - **더보기**:   
   - 작업 열에서 **더보기 > 편집**을 클릭하여 워크플로 구성을 수정할 수 있는 ‘워크플로 편집’ 페이지로 이동합니다.
   - 작업 열에서 **더보기 > 삭제**를 클릭하여 워크플로를 삭제합니다.

>! 활성화된 워크플로는 편집하거나 삭제할 수 없습니다.
>

### 실행 인스턴스 보기

각 비디오 파일에 대해 워크플로우가 실행된 후 실행 인스턴스가 생성됩니다. 실행 인스턴스 페이지에는 소스 파일 주소, 워크플로 실행 상태 및 실행 시간이 표시됩니다.

1. 워크플로 관리 페이지로 이동하여 대상 워크플로의 작업 열에서 **실행 인스턴스 보기**를 클릭하여 실행 인스턴스 목록 페이지로 들어갑니다.

2. 목록 페이지에서 대상 인스턴스의 작업 열에 있는 **세부 정보**를 클릭하여 인스턴스 세부 정보 페이지로 들어갑니다.

3. 인스턴스 세부 정보 페이지에서 각 워크플로 노드의 작업 ID, 실행 상태, 시작 시간 및 종료 시간을 볼 수 있습니다.


### 워크플로 트리거

워크플로가 생성된 후 지정된 버킷에 업로드된 파일에 대해 자동으로 트리거되거나 버킷의 기존 파일에 대해 수동으로 트리거될 수 있습니다.

1. 워크플로 관리 페이지에서 대상 워크플로의 **더보기 > 실행 인스턴스 생성**을 클릭합니다.
2. 실행 인스턴스 생성 페이지에서 워크플로를 트리거할 파일을 선택하고 **저장**을 클릭하여 워크플로를 즉시 트리거하고 실행합니다.
   실행 인스턴스 페이지에서 워크플로 실행 상태를 볼 수 있습니다.
   ![](https://qcloudimg.tencent-cloud.cn/raw/8e5bdd5477861a20499f91eb85d49fb7.png)


<span id="1"></span>

## 워크플로 변수 설명


워크플로는 다음 변수를 사용하여 렌더링 대상 파일 이름 및 URL을 지원합니다.

| 변수 이름        | 설명                         |
| :-------------- | :--------------------------- |
| InputName       | 입력 파일의 파일 이름(파일 확장자 없음) |
| InputNameAndExt | 입력 파일의 파일 이름(파일 확장자 포함)   |
| InputPath       | 파일 입력 경로               |
| RunId           | 실행 인스턴스 ID                  |
| Ext             | 대상 파일 형식               |
| Number          | 대상 파일 번호               |

#### 예시


입력 파일의 이름이 test1.mp4 및 test2.mp4이고 이를 FLV 형식으로 변환하려는 경우(최종 파일 이름은 test1.flv 및 test2.flv) 대상 파일 이름의 매개 변수 형식을 `${InputName}.${Ext}`로 설정합니다.

대상 파일 이름의 매개 변수 형식이 `${InputNameAndExt}_${RunId}.${Ext}`로 설정된 경우.

워크플로가 실행 중에 두 개의 인스턴스(000001 및 000002)를 생성하면 최종 파일 이름은 test1.mp4_000001.flv 및 test2.mp4_000002.flv가 됩니다.



